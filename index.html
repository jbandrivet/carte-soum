<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G√©n√©rateur d'Image Personnalis√©</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#1a1a1a 0%,#2d2d30 50%,#1a1a1a 100%);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;}
.container{background:rgba(44,44,44,0.95);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 15px 35px rgba(0,0,0,0.7),0 0 0 1px rgba(255,255,255,0.1);padding:30px 40px;max-width:650px;width:100%;border:1px solid rgba(255,0,0,0.3);position:relative;overflow:hidden;}
.container::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,#ff0000,transparent);}
h1{text-align:center;margin-bottom:25px;font-size:2.5rem;background:linear-gradient(45deg,#ff0000,#cc0000);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 30px rgba(255,0,0,0.5);}
.form-group{margin-bottom:20px;}
label{display:block;margin-bottom:8px;font-weight:600;color:#e0e0e0;font-size:1.1rem;}
input[type="file"],textarea,select,input[type="text"],input[type="tel"]{width:100%;padding:12px;border:2px solid rgba(255,0,0,0.3);border-radius:12px;background:rgba(51,51,51,0.8);color:#fff;font-size:1rem;transition:all 0.3s ease;}
input:focus,textarea:focus,select:focus{outline:none;border-color:#ff0000;box-shadow:0 0 20px rgba(255,0,0,0.3);transform:translateY(-2px);}
textarea{resize:vertical;min-height:80px;font-family:inherit;}
.controls-row{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px;}
.slider-group{display:flex;flex-direction:column;}
input[type="range"]{width:100%;margin:10px 0;-webkit-appearance:none;appearance:none;height:6px;background:rgba(255,255,255,0.2);border-radius:3px;outline:none;}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:#ff0000;border-radius:50%;cursor:pointer;box-shadow:0 0 10px rgba(255,0,0,0.5);}
input[type="range"]::-moz-range-thumb{width:20px;height:20px;background:#ff0000;border-radius:50%;cursor:pointer;border:none;box-shadow:0 0 10px rgba(255,0,0,0.5);}
.color-picker{display:flex;align-items:center;gap:10px;}
input[type="color"]{width:50px;height:40px;border:none;border-radius:8px;cursor:pointer;background:none;}
button{width:100%;background:linear-gradient(45deg,#ff0000,#cc0000);color:#fff;padding:16px;border:none;border-radius:12px;cursor:pointer;font-size:1.1rem;font-weight:bold;transition:all 0.3s ease;text-transform:uppercase;letter-spacing:1px;position:relative;overflow:hidden;margin-bottom:10px;}
button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.5s ease;}
button:hover::before{left:100%;}
button:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(255,0,0,0.4);}
button:active{transform:translateY(-1px);}
button:disabled{opacity:0.6;cursor:not-allowed;transform:none;}
.preview-container{margin-top:20px;text-align:center;}
#preview{max-width:100%;max-height:500px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.5);border:2px solid rgba(255,0,0,0.5);display:none;}
#downloadLink{display:none;margin-top:15px;padding:12px 20px;background:rgba(255,0,0,0.1);color:#ff0000;text-decoration:none;border-radius:8px;font-weight:bold;border:1px solid rgba(255,0,0,0.3);transition:all 0.3s ease;}
#downloadLink:hover{background:rgba(255,0,0,0.2);transform:translateY(-2px);}
.loading{display:none;text-align:center;margin-top:15px;}
.spinner{border:3px solid rgba(255,255,255,0.3);border-radius:50%;border-top:3px solid #ff0000;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto;}
@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
.value-display{font-size:0.9rem;color:#ff0000;font-weight:bold;}
.photo-preview,.id-preview{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:10px;margin-top:10px;}
.preview-img{position:relative;border-radius:8px;overflow:hidden;border:2px solid rgba(255,0,0,0.3);aspect-ratio:1;}
.preview-img img{width:100%;height:100%;object-fit:cover;}
.preview-img .remove-btn{position:absolute;top:5px;right:5px;background:rgba(255,0,0,0.9);color:#fff;border:none;border-radius:50%;width:25px;height:25px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;z-index:10;}
.preview-img .remove-btn:hover{background:#ff0000;transform:scale(1.1);}
.button-row{display:flex;gap:10px;margin-bottom:10px;}
small{font-size:0.85rem;}
@media (max-width:768px){.controls-row{grid-template-columns:1fr;}.container{padding:20px;margin:10px;}h1{font-size:2rem;}.button-row{flex-direction:column;}.button-row button{width:100%!important;}}
</style>
</head>
<body>
<div class="container">
<h1>üé® G√©n√©rateur d'Image</h1>
<form id="imageForm">
<div class="form-group">
<label for="photos">üì∏ Choisir jusqu'√† 6 photos :</label>
<input type="file" id="photos" accept="image/*" capture="environment" multiple required>
<div id="photoPreview" class="photo-preview"></div>
</div>
<div class="form-group">
<label for="idCard">üÜî Carte d'identit√© (facultatif) :</label>
<input type="file" id="idCard" accept="image/*">
<div id="idPreview" class="id-preview"></div>
</div>
<div class="form-group">
<label>Position carte d'identit√© :</label>
<select id="idPosition">
<option value="bottom-right">En bas √† droite</option>
<option value="bottom-left">En bas √† gauche</option>
<option value="top-right">En haut √† droite</option>
<option value="top-left">En haut √† gauche</option>
<option value="center">Au centre</option>
</select>
</div>
<div class="form-group">
<label for="firstName">üë§ Pr√©nom :</label>
<input type="text" id="firstName" placeholder="Votre pr√©nom" required>
</div>
<div class="form-group">
<label for="lastName">üë§ Nom :</label>
<input type="text" id="lastName" placeholder="Votre nom" required>
</div>
<div class="form-group">
<label for="phone">üìû Num√©ro de t√©l√©phone :</label>
<input type="tel" id="phone" placeholder="Ex: +33 6 12 34 56 78" pattern="[\+]?[0-9\s\-\(\)]+" required>
<small style="color:#999;display:block;margin-top:5px;">Format: international recommand√©</small>
</div>
<div class="form-group">
<label for="social">üì± Profil r√©seau social :</label>
<input type="text" id="social" placeholder="Ex: @monprofil">
</div>
<div class="form-group">
<label for="info">‚úèÔ∏è Texte personnalis√© :</label>
<textarea id="info" placeholder="Entrez un message..."></textarea>
</div>
<div class="form-group">
<label for="theme">üé® Choisir un overlay :</label>
<select id="theme">
<option value="none">Aucun</option>
<option value="chains">Cha√Ænes m√©talliques</option>
<option value="leather">Texture cuir</option>
<option value="ropes">Cordes entrelac√©es</option>
<option value="geometric">Motifs g√©om√©triques</option>
<option value="smoke">Effet fum√©e</option>
</select>
</div>
<div class="controls-row">
<div class="slider-group">
<label for="textSize">üìè Taille texte: <span id="textSizeValue" class="value-display">40px</span></label>
<input type="range" id="textSize" min="20" max="80" value="40">
</div>
<div class="slider-group">
<label for="overlayOpacity">üé≠ Opacit√©: <span id="overlayOpacityValue" class="value-display">30%</span></label>
<input type="range" id="overlayOpacity" min="10" max="80" value="30">
</div>
</div>
<div class="controls-row">
<div class="slider-group">
<label for="imageQuality">‚ö° Qualit√©: <span id="imageQualityValue" class="value-display">92%</span></label>
<input type="range" id="imageQuality" min="60" max="100" value="92">
</div>
<div class="slider-group">
<label for="borderWidth">üìê Bordure: <span id="borderWidthValue" class="value-display">8px</span></label>
<input type="range" id="borderWidth" min="0" max="20" value="8">
</div>
</div>
<div class="controls-row">
<div class="color-picker">
<label for="textColor">üé® Couleur texte:</label>
<input type="color" id="textColor" value="#ff0000">
</div>
<div class="color-picker">
<label for="borderColor">üñºÔ∏è Couleur bordure:</label>
<input type="color" id="borderColor" value="#ff0000">
</div>
</div>
<div class="form-group">
<label><input type="checkbox" id="livePreview" style="width:auto;margin-right:8px;">üëÅÔ∏è Pr√©visualisation temps r√©el</label>
</div>
<div class="form-group">
<label for="outputSize">üì± Taille de sortie :</label>
<select id="outputSize">
<option value="1920x1080">Full HD (1920x1080)</option>
<option value="1280x720">HD (1280x720)</option>
<option value="3840x2160">4K (3840x2160)</option>
<option value="1080x1920">Story Instagram (1080x1920)</option>
<option value="1080x1080">Carr√© Instagram (1080x1080)</option>
</select>
</div>
<button type="submit" id="generateBtn">üé® G√©n√©rer l'image</button>
<div class="button-row">
<button type="button" id="translateBtn" style="width:48%;">üåê EN</button>
<button type="button" id="resetBtn" style="width:48%;">üîÑ R√©initialiser</button>
</div>
</form>
<div class="loading" id="loading"><div class="spinner"></div><p>G√©n√©ration en cours...</p></div>
<div class="preview-container">
<canvas id="previewCanvas" style="display:none;"></canvas>
<img id="preview" src="" alt="Image g√©n√©r√©e"/>
<br>
<a id="downloadLink" href="#" download="image_personnalisee.jpg">‚¨áÔ∏è T√©l√©charger l'image</a>
</div>
</div>
<script>
const sliders={textSize:{elem:document.getElementById('textSize'),display:document.getElementById('textSizeValue'),suffix:'px'},overlayOpacity:{elem:document.getElementById('overlayOpacity'),display:document.getElementById('overlayOpacityValue'),suffix:'%'},imageQuality:{elem:document.getElementById('imageQuality'),display:document.getElementById('imageQualityValue'),suffix:'%'},borderWidth:{elem:document.getElementById('borderWidth'),display:document.getElementById('borderWidthValue'),suffix:'px'}};
Object.entries(sliders).forEach(([key,{elem,display,suffix}])=>{elem.addEventListener('input',()=>{display.textContent=elem.value+suffix;if(document.getElementById('livePreview').checked)generatePreview();});});
let photosArray=[];
const photosInput=document.getElementById('photos');
const photoPreview=document.getElementById('photoPreview');
photosInput.addEventListener('change',(e)=>{const files=Array.from(e.target.files).slice(0,6);photosArray=[];photoPreview.innerHTML='';files.forEach((file,index)=>{const reader=new FileReader();reader.onload=(ev)=>{const img=new Image();img.onload=()=>{photosArray.push(img);const div=document.createElement('div');div.className='preview-img';div.innerHTML=`<img src="${ev.target.result}" alt="Photo ${index+1}"><button class="remove-btn" onclick="removePhoto(${index})">√ó</button>`;photoPreview.appendChild(div);};img.src=ev.target.result;};reader.readAsDataURL(file);});});
window.removePhoto=(index)=>{photosArray.splice(index,1);photoPreview.children[index].remove();};
let idCardImage=null;
const idCardInput=document.getElementById('idCard');
const idPreview=document.getElementById('idPreview');
idCardInput.addEventListener('change',(e)=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=(ev)=>{const img=new Image();img.onload=()=>{idCardImage=img;idPreview.innerHTML=`<div class="preview-img"><img src="${ev.target.result}" alt="Carte ID"><button class="remove-btn" onclick="removeIdCard()">√ó</button></div>`;};img.src=ev.target.result;};reader.readAsDataURL(file);});
window.removeIdCard=()=>{idCardImage=null;idPreview.innerHTML='';idCardInput.value='';};
function drawOverlay(ctx,w,h,theme,opacity){if(theme==='none')return;ctx.globalAlpha=opacity/100;switch(theme){case 'chains':ctx.strokeStyle='rgba(150,150,150,0.7)';ctx.lineWidth=6;for(let i=0;i<10;i++){ctx.beginPath();ctx.arc(Math.random()*w,Math.random()*h,30,0,Math.PI*2);ctx.stroke();}break;case 'leather':ctx.fillStyle='rgba(100,50,30,0.3)';ctx.fillRect(0,0,w,h);for(let i=0;i<100;i++){ctx.fillStyle=`rgba(${80+Math.random()*40},${40+Math.random()*20},20,0.1)`;ctx.fillRect(Math.random()*w,Math.random()*h,Math.random()*50,Math.random()*50);}break;case 'ropes':ctx.strokeStyle='rgba(139,90,43,0.6)';ctx.lineWidth=8;for(let i=0;i<5;i++){ctx.beginPath();ctx.moveTo(0,i*h/5);ctx.lineTo(w,i*h/5+50);ctx.stroke();}break;case 'geometric':ctx.strokeStyle='rgba(255,0,0,0.4)';ctx.lineWidth=3;const size=100;for(let x=0;x<w;x+=size){for(let y=0;y<h;y+=size){ctx.strokeRect(x,y,size,size);ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x+size,y+size);ctx.stroke();}}break;case 'smoke':const gradient=ctx.createRadialGradient(w/2,h/2,0,w/2,h/2,Math.max(w,h)/2);gradient.addColorStop(0,'rgba(80,80,80,0)');gradient.addColorStop(0.5,'rgba(60,60,60,0.3)');gradient.addColorStop(1,'rgba(40,40,40,0.5)');ctx.fillStyle=gradient;ctx.fillRect(0,0,w,h);break;}ctx.globalAlpha=1.0;}
function wrapText(ctx,text,x,y,maxWidth,lineHeight){const lines=text.split('\n');let currentY=y;lines.forEach(line=>{if(!line.trim()){currentY+=lineHeight;return;}const words=line.split(' ');let currentLine='';words.forEach(word=>{const testLine=currentLine+word+' ';const metrics=ctx.measureText(testLine);if(metrics.width>maxWidth&&currentLine){ctx.strokeText(currentLine,x,currentY);ctx.fillText(currentLine,x,currentY);currentLine=word+' ';currentY+=lineHeight;}else{currentLine=testLine;}});ctx.strokeText(currentLine,x,currentY);ctx.fillText(currentLine,x,currentY);currentY+=lineHeight;});}
function getIdCardPosition(w,h,idW,idH,position){const margin=20;const positions={'bottom-right':{x:w-idW-margin,y:h-idH-margin},'bottom-left':{x:margin,y:h-idH-margin},'top-right':{x:w-idW-margin,y:margin},'top-left':{x:margin,y:margin},'center':{x:(w-idW)/2,y:(h-idH)/2}};return positions[position]||positions['bottom-right'];}
const form=document.getElementById('imageForm');
const preview=document.getElementById('preview');
const downloadLink=document.getElementById('downloadLink');
const loading=document.getElementById('loading');
const generateBtn=document.getElementById('generateBtn');
const canvas=document.getElementById('previewCanvas');
const ctx=canvas.getContext('2d');
async function generatePreview(){if(photosArray.length===0)return;const firstName=document.getElementById('firstName').value;const lastName=document.getElementById('lastName').value;const phone=document.getElementById('phone').value;const social=document.getElementById('social').value;const info=document.getElementById('info').value;const theme=document.getElementById('theme').value;const textSize=parseInt(document.getElementById('textSize').value);const overlayOpacity=parseInt(document.getElementById('overlayOpacity').value);const textColor=document.getElementById('textColor').value;const borderColor=document.getElementById('borderColor').value;const borderWidth=parseInt(document.getElementById('borderWidth').value);const quality=parseInt(document.getElementById('imageQuality').value)/100;const idPosition=document.getElementById('idPosition').value;const[width,height]=document.getElementById('outputSize').value.split('x').map(Number);canvas.width=width;canvas.height=height;ctx.clearRect(0,0,width,height);const numPhotos=photosArray.length;let cols,rows;if(numPhotos<=2){cols=numPhotos;rows=1;}else if(numPhotos<=4){cols=2;rows=2;}else{cols=3;rows=2;}const imgW=width/cols;const imgH=height/rows;photosArray.forEach((img,i)=>{const col=i%cols;const row=Math.floor(i/cols);const x=col*imgW;const y=row*imgH;const scale=Math.max(imgW/img.width,imgH/img.height);const scaledW=img.width*scale;const scaledH=img.height*scale;const offsetX=x+(imgW-scaledW)/2;const offsetY=y+(imgH-scaledH)/2;ctx.drawImage(img,offsetX,offsetY,scaledW,scaledH);});if(idCardImage){const idW=width/4;const idH=idW*(idCardImage.height/idCardImage.width);const pos=getIdCardPosition(width,height,idW,idH,idPosition);ctx.fillStyle='rgba(0,0,0,0.5)';ctx.fillRect(pos.x-5,pos.y-5,idW+10,idH+10);ctx.drawImage(idCardImage,pos.x,pos.y,idW,idH);ctx.strokeStyle=borderColor;ctx.lineWidth=3;ctx.strokeRect(pos.x,pos.y,idW,idH);}drawOverlay(ctx,width,height,theme,overlayOpacity);const textLines=[firstName&&lastName?`${firstName} ${lastName}`:'',phone?`üìû ${phone}`:'',social?`üì± ${social}`:'',info].filter(Boolean);const finalText=textLines.join('\n');if(finalText.trim()){ctx.font=`bold ${textSize}px Impact, Arial Black, sans-serif`;const padding=20;const lineHeight=textSize*1.3;const textHeight=textLines.length*lineHeight+padding*2;ctx.fillStyle='rgba(0,0,0,0.6)';ctx.fillRect(0,0,width,textHeight);ctx.fillStyle=textColor;ctx.strokeStyle='#000';ctx.lineWidth=Math.max(2,textSize/20);ctx.textAlign='left';ctx.textBaseline='top';wrapText(ctx,finalText,padding,padding,width-padding*2,lineHeight);}if(borderWidth>0){ctx.strokeStyle=borderColor;ctx.lineWidth=borderWidth;ctx.strokeRect(borderWidth/2,borderWidth/2,width-borderWidth,height-borderWidth);}const dataURL=canvas.toDataURL('image/jpeg',quality);preview.src=dataURL;preview.style.display='block';downloadLink.href=dataURL;downloadLink.download=`${firstName}_${lastName}_${Date.now()}.jpg`.replace(/\s+/g,'_');downloadLink.style.display='inline-block';}
form.addEventListener('submit',async e=>{e.preventDefault();if(photosArray.length===0){alert('‚ö†Ô∏è Veuillez s√©lectionner au moins une image.');return;}loading.style.display='block';generateBtn.disabled=true;preview.style.display='none';downloadLink.style.display='none';await generatePreview();loading.style.display='none';generateBtn.disabled=false;});
['textSize','overlayOpacity','imageQuality','borderWidth','textColor','borderColor','theme','idPosition','outputSize'].forEach(id=>{const elem=document.getElementById(id);if(elem){elem.addEventListener('change',()=>{if(document.getElementById('livePreview').checked&&photosArray.length>0){generatePreview();}});}});
['firstName','lastName','phone','social','info'].forEach(id=>{document.getElementById(id).addEventListener('input',()=>{if(document.getElementById('livePreview').checked&&photosArray.length>0){clearTimeout(window.previewTimeout);window.previewTimeout=setTimeout(generatePreview,500);}});});
document.getElementById('translateBtn').addEventListener('click',()=>{const fields=['firstName','lastName','info'];fields.forEach(id=>{const elem=document.getElementById(id);if(elem.value&&!elem.value.startsWith('[EN]')){elem.value=`[EN] ${elem.value}`;}});});
document.getElementById('resetBtn').addEventListener('click',()=>{if(confirm('üîÑ Voulez-vous vraiment r√©initialiser tous les champs ?')){form.reset();photosArray=[];idCardImage=null;photoPreview.innerHTML='';idPreview.innerHTML='';preview.style.display='none';downloadLink.style.display='none';Object.entries(sliders).forEach(([key,{elem,display,suffix}])=>{display.textContent=elem.value+suffix;});}});
</script>
</body>
</html>
